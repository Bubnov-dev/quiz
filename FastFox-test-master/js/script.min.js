$(document).ready((function(){var e=new Map([["EyeZen",{logo:"img/lensbuilder/Essilor_LogoBrand_Eyezen_White.png",title:"Улучшенные однофокальные линзы",icons:["img/lensbuilder/icons/EYEZEN ICONS-01.svg","img/lensbuilder/icons/EYEZEN ICONS-02.svg","img/lensbuilder/icons/EYEZEN ICONS-03.svg"]}],["Varilux",{logo:"img/lensbuilder/logos/Essilor_LogoBrand_Varilux_White.png",title:"",icons:["img/lensbuilder/icons/VARILUX ICONS-01.svg","img/lensbuilder/icons/VARILUX ICONS-02.svg","img/lensbuilder/icons/VARILUX ICONS-03.svg"]}],["Stellest",{logo:"img/lensbuilder/logos/Essilor_LogoBrand_Stellest_White.png",title:"Коррекция миопии и четкое зрение вдаль",icons:["img/lensbuilder/icons/EYEZEN ICONS-02.svg","img/lensbuilder/icons/EYEZEN ICONS-03.svg"]}],["Transitions",{logo:"img/lensbuilder/logos/transitions_logo_white.png",title:"Легко адаптируются к меняющемуся освещению",icons:["img/lensbuilder/icons/TRANSITIONS ICONS-01.svg","img/lensbuilder/icons/TRANSITIONS ICONS-02.svg","img/lensbuilder/icons/TRANSITIONS ICONS-03.svg"]}],["Crizal Alize",{logo:"img/lensbuilder/logos/Essilor_LogoProduct_Crizal_AlizeUV_White.png",title:"Защита от ультрафиолета и 5 врагов прозрачности линзы",icons:["img/lensbuilder/icons/CRIZAL ICONS-01.svg","img/lensbuilder/icons/CRIZAL ICONS-02.svg","img/lensbuilder/icons/CRIZAL ICONS-03.svg"]}],["Crizal Prevencia",{logo:"img/lensbuilder/logos/Essilor_LogoProduct_Crizal_Prevencia_White.png",title:"Защита от ультрафиолета, синего света и 5 врагов прозрачности линзы",icons:["img/lensbuilder/icons/CRIZAL ICONS-01.svg","img/lensbuilder/icons/CRIZAL ICONS-02.svg","img/lensbuilder/icons/CRIZAL ICONS-03.svg"]}],["Crizal Sapphire",{logo:"img/lensbuilder/logos/Essilor_LogoProduct_Crizal_SapphireUV_White.png",title:"Защита от ультрафиолета и 5 врагов прозрачности линзы",icons:["img/lensbuilder/icons/CRIZAL ICONS-01.svg","img/lensbuilder/icons/CRIZAL ICONS-02.svg","img/lensbuilder/icons/CRIZAL ICONS-03.svg"]}]]),l=[{no:[{name:"vision-challenge",val:"kids"},{name:"vision-challenge-age",val:"45+"}],yes:[],more:[],less:[],value:"EyeZen"},{no:[{name:"vision-challenge",val:"kids"}],yes:[{name:"vision-challenge-age",val:"45+"}],more:[],less:[],value:"Varilux"},{no:[{name:"vision-challenge",val:"kids"},{name:"experience",val:"crizalsa"}],yes:[{name:"vision-challenge-age",val:"45+"}],more:[],less:[],value:"Crizal Prevencia"},{no:[{name:"children-problem",val:"kid-near"}],yes:[],more:[],less:[{name:"most-day",val:.85}],value:"Transitions"},{no:[{name:"experience",val:"crizalsa"}],yes:[],more:[],less:[{name:"in-comp",val:2}],value:"Crizal Alize"},{no:[{name:"experience",val:"crizalsa"}],yes:[],more:[{name:"in-comp",val:1}],less:[],value:"Crizal Prevencia"},{no:[],yes:[{name:"experience",val:"crizalsa"}],more:[],less:[],value:"Crizal Sapphire"},{no:[],yes:[{name:"vision-challenge",val:"kids"},{name:"children-problem",val:"kid-near"}],more:[],less:[],value:"Stellest"}],i=function(e,l,i){let n="";return i.forEach(e=>{n=n+'<img src="'+e+'" alt="">'}),'<div class="brand-template-wrapper"><div class="brand-template"><div class="brand-template__logo"><img src="'+e+'" alt=""></div><div class="brand-template__title">'+l+'</div><div class="brand-template__icons">'+n+"</div></div></div>"};if(""!=window.location.search){var n=window.location.search.replace("?","").split("&").reduce((function(e,l){var i=l.split("=");return e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]),e}),{});console.log(n),console.log("params");let e=[];for(var s in n)e.push({name:s,val:n[s]});console.log(e),$(".js-lens-builder__start-screen").addClass("hidden"),$(".questions").addClass("hidden"),$(".test__result").removeClass("hidden"),v(e)}$("#mainpage_button").on("click",(function(){$(".questions").removeClass("hidden"),$(".js-lens-builder__start-screen").addClass("hidden")})),$("#timer-range").slider({animate:"slow",min:0,max:12,value:0}),$("#timer-range").slider({slide:function(e,l){$(".circle").html(l.value),$(".num").html("<strong>"+l.value+"</strong><small> ЧАСОВ</small>"),o(".circle",l.value),$(".time-slider").find(".real-val").text(l.value)}});var o=function(e,l){var i=document.querySelector(e),n=parseFloat(i.innerHTML);n=526*l/12+1,i.innerHTML=' <svg width="178" height="178"><circle transform="rotate(-90)" style="stroke-dasharray:'+n+'px 526px;" r="84" cx="-89" cy="89" /></svg>'};o(".circle"),$(".kids-input").on("click",(function(){let e="ГДЕ ВАШ РЕБЕНОК ПРОВОДИТ БОЛЬШУЮ ЧАСТЬ СВОЕГО ДНЯ?";$("#step-4").find(".lens-builder__question-title").text(e),e="СКОЛЬКО ЧАСОВ В ДЕНЬ ВАШ РЕБЕНОК ПРОВОДИТ ПЕРЕД ЭКРАНОМ КОМПЬЮТЕРА, ТЕЛЕФОНА, ТЕЛЕВИЗОРА И Т.Д.?",$("#step-3").find(".lens-builder__question-title").text(e),e="Линзы для очков моего ребенка должны быть:",$("#step-5").find(".lens-builder__question-title").text(e),e="УЧАСТВУЕТ ЛИ ВАШ РЕБЕНОК В КАКОЙ-ЛИБО ИЗ СЛЕДУЮЩИХ АКТИВНОСТЕЙ?",$("#step-6").find(".lens-builder__question-title").text(e)}));let a=0,t=$(".question"),r=t.length,c=$(".back-btn"),d=$(".lens-builder__arrow--next");function g(e){console.log("next"),4==a&&$(".most-day-real-val").html($(".twentytwenty-handle").css("left").replace(/[a-z]/gi,"")/$("#filter-image-wrapper").width()),a++,c.removeClass("disable"),e&&(a+=Number(e)),r<=a?($(".questions").addClass("hidden"),$(".test__result").removeClass("hidden"),v()):(d.addClass("disable"),m()),console.log("q"+a),4==a&&$("#filter-image-wrapper").twentytwenty({no_overlay:!0})}function m(){t.addClass("hidden");try{t.eq(a).removeClass("hidden"),t.eq(a).find("input:checked").length>0&&d.removeClass("disable")}catch(e){}}function v(n=[]){let s=$("input:checked"),o=$(".real-val");0==n.length&&(console.log("ща будут результаты"),s.each((function(e,l){n.push({name:l.getAttribute("name"),val:$(l).val()})})),o.each((function(e,l){n.push({name:l.getAttribute("data-name"),val:$(l).text()})})));let a=window.location.origin+window.location.pathname+"?";n.forEach(e=>{a+=e.name+"="+e.val+"&"}),a=a.substr(0,a.length-1),console.log(a);var t="mailto:?body="+encodeURIComponent("Основываясь на ваших ответах, мы рекомендуем следующее решение, соответствующее вашему образу жизни и потребностям:\n"+a);$("a.mailto").attr("href",t),console.log(n);let r=n[0].name,c="<li>",d=0;n.forEach(e=>{let l;0!=d&&(e.name!=r?c+="</li><li>":c+=", "),l="in-comp"==e.name?"Часов перед компьютером: "+e.val:"most-day"==e.name?e.val<.15?"Весь день на улице":e.val<.35?"В основном на улице":e.val<.65?"Часть времени в помещении, часть – на улице":e.val<.85?"В основном в помещении":"Весь день в помещении":$('[name="'+e.name+'"][value="'+e.val+'"]+label span').html(),c+=l,r=e.name,d++}),c+="</li>",$(".lens-builder__bullets").html($(c)),d=0;let g=new Set;l.forEach(l=>{let s=!0;console.log(l),l.no!=[]&&l.no.forEach(e=>{n.forEach(l=>{console.log("no: "+JSON.stringify(e)+" "+JSON.stringify(l)),JSON.stringify(e)==JSON.stringify(l)&&(s=!1)})});let o=!0;l.yes!=[]&&l.yes.forEach(e=>{let l=!1;n.forEach(i=>{console.log("yes: "+JSON.stringify(e)+" "+JSON.stringify(i)),JSON.stringify(e)==JSON.stringify(i)&&(l=!0)}),l||(o=!1)});let a=!0;l.more!=[]&&l.more.forEach(e=>{tmpRes=!1,n.forEach(l=>{e.name==l.name&&(console.log("more : "+l.val+" "+e.val),l.val>e.val&&(tmpRes=!0))}),tmpRes||(a=!1)});let t=!0;if(l.less!=[]&&l.less.forEach(e=>{tmpRes=!1,n.forEach(l=>{e.name==l.name&&(console.log("less: "+l.val+" "+e.val),l.val<e.val&&(tmpRes=!0))}),tmpRes||(t=!1)}),console.log(s,o,a,t),s&&o&&a&&t){let n=g.size;g.add(l.value),g.size!=n&&(console.log(l.value),$('[data-brand="'+l.value+'"]').removeClass("hidden"),console.log(e.get(l.value)),0==d?$(".position-right .position-wrapper").html(i(e.get(l.value).logo,e.get(l.value).title,e.get(l.value).icons)):$(".position-left .position-wrapper").html($(".position-left .position-wrapper").html()+i(e.get(l.value).logo,e.get(l.value).title,e.get(l.value).icons)),$(".position-mobile").html($(".position-mobile").html()+('<div class="brand-logo-mobile"><img src="'+e.get(l.value).logo+'" alt=""></div>')),d++)}}),console.log(g)}$("input").removeAttr("checked"),d.on("click",(function(){g()})),c.on("click",(function(){a>0&&(a--,d.removeClass("disable"),m(),0==a&&c.addClass("disable"))})),$(".question input:radio").on("change",(function(){$(this).attr("data-to-skip")?(console.log("has attr"),g($(this).attr("data-to-skip"))):g()})),t.each(()=>{let e=$(this);$("input:checkBox").on("change",(function(){d.removeClass("disable"),e.find("input:checkbox:checked").length>0?d.removeClass("disable"):d.addClass("disable")}))}),m()}));